simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
if_else(dqrunif(1) < .5, 1, 0),
if_else(dqrunif(1) < .5, 1, 0)
),
)
print(simTibble,n=30)
n<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
if_else(dqrunif(1) < .5, 1, 0),
3
),
)
print(simTibble,n=30)
n<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
if_else(dqrunif(1) < .5, 1, 0),
3
),
)
print(simTibble,n=30)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
3,
if_else(dqrunif(1) < .5, 1, 0),
),
)
print(simTibble,n=30)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
3,
if_else(dqrunif(1) < .5, 1, 0),
),
)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
3,
if_else(dqrunif(1) < .5, 1, 0)
),
)
print(simTibble,n=30)
n<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
if_else(dqrunif(1) < .5, 1, 0),
if_else(dqrunif(1) < .5, 1, 0),
),
)
n<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
p1conf = if_else(dqrunif(n) < .5, 0, 1),
p2conf = if_else(dqrunif(n) < .5, 0, 1),
p1rslt = ifelse(
p1conf == 1,
if_else(dqrunif(1) < .5, 1, 0),
if_else(dqrunif(1) < .5, 1, 0)
),
)
print(simTibble,n=30)
dqrunif(1)
n<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:n,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
confA1 = if_else(confRNG1 < conf1, 0, 1),
accA1 = if_else(
confA1 == 1,
if_else(accRNG1 < hi1, 1, 0),
if_else(accRNG1 < lo1, 1, 0)
),
confA2 = if_else(confRNG2 < conf2, 0, 1),
accA2 = if_else(
confA2 == 1,
if_else(accRNG2 < hi2, 1, 0),
if_else(accRNG2 < lo2, 1, 0)
)
)
trls<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
confA1 = if_else(confRNG1 < conf1, 0, 1),
accA1 = if_else(
confA1 == 1,
if_else(accRNG1 < hi1, 1, 0),
if_else(accRNG1 < lo1, 1, 0)
),
confA2 = if_else(confRNG2 < conf2, 0, 1),
accA2 = if_else(
confA2 == 1,
if_else(accRNG2 < hi2, 1, 0),
if_else(accRNG2 < lo2, 1, 0)
)
)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
confA1 = if_else(confRNG1 < .5, 0, 1),
accA1 = if_else(
confA1 == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)
),
confA2 = if_else(confRNG2 < 5, 0, 1),
accA2 = if_else(
confA2 == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)
)
)
print(simTibble,n=30)
trls<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
p1rslt = dqrunif(trls),
p2rslt = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
accA1 = if_else(
p1conf == 1,
if_else(p1rslt < .8, 1, 0),
if_else(p1rslt < .6, 1, 0)
),
p2conf = if_else(confRNG2 < 5, 0, 1),
accA2 = if_else(
p2conf == 1,
if_else(p2rslt < .7, 1, 0),
if_else(p2rslt < .7, 1, 0)
)
)
print(simTibble,n=30)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
p1rslt = dqrunif(trls),
p2rslt = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
accA1 = if_else(
p1conf == 1,
if_else(p1rslt < .8, 1, 0),
if_else(p1rslt < .6, 1, 0)
),
p2conf = if_else(confRNG2 < 5, 0, 1),
accA2 = if_else(
p2conf == 1,
if_else(p2rslt < .7, 1, 0),
if_else(p2rslt < .7, 1, 0)
)
) %>%
select(subID,trialNum,p1conf,p2conf,p1rslt,p2rslt)
print(simTibble,n=30)
trls<-100
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
accA1 = if_else(
p1conf == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)
),
p2conf = if_else(confRNG2 < 5, 0, 1),
accA2 = if_else(
p2conf == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)
)
)
print(simTibble,n=30)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
p1rslt = if_else(
p1conf == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)
),
p2conf = if_else(confRNG2 < 5, 0, 1),
p2rslt = if_else(
p2conf == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)
)
)
print(simTibble,n=30)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
p1rslt = if_else(
p1conf == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)
),
p2conf = if_else(confRNG2 < 5, 0, 1),
p2rslt = if_else(
p2conf == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)
)
) %>%
select(subID,trialNum,p1conf,p2conf,p1rslt,p2rslt)
print(simTibble,n=30)
print(simTibble,n=15)
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
p1rslt = if_else(
p1conf == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)
),
p2conf = if_else(confRNG2 < 5, 0, 1),
p2rslt = if_else(
p2conf == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)
)
) %>%
select(subID,trialNum,p1conf,p2conf,p1rslt,p2rslt)
print(simTibble,n=15)
packages <- c('tidyverse', 'Cairo', 'dqrng')
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))
rm(packages, installed_packages)
library(readr)
simData <-
read_csv("simData.csv",
col_types = cols(cntBalance = col_skip(),
rt = col_skip()))
set.seed(1)
trls <- 400
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
correctRNG = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
p1rslt = if_else(p1conf == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)),
p2conf = if_else(confRNG2 < .5, 0, 1),
p2rslt = if_else(p2conf == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)),
correct = if_else(correctRNG < .5, 0, 1),
) %>%
select(subID, trialNum, correct, p1conf, p2conf, p1rslt, p2rslt)
print(simTibble, n = 15)
data <- mutate(simTibble,
advAgree = ifelse(p1rslt == p2rslt, 1, 0), ) %>%
filter(advAgree == 0) %>%
group_by(subID) %>%
summarise(
disagree = sum(advAgree != ''),
LL = sum(p1conf == 0 & p2conf == 0),
HH = sum(p1conf == 1 & p2conf == 1),
LH = sum(p1conf == 1 & p2conf == 0),
HL = sum(p1conf == 0 & p2conf == 1),
LL1 = sum(p1conf == 0 &
p2conf == 0 & correct == p1rslt),
HH1 = sum(p1conf == 1 &
p2conf == 1 & correct == p1rslt),
LH1 = sum(p1conf == 1 &
p2conf == 0 & correct == p1rslt),
HL1 = sum(p1conf == 0 &
p2conf == 1 & correct == p1rslt),
LL2 = sum(p1conf == 0 &
p2conf == 0 & correct == p2rslt),
HH2 = sum(p1conf == 1 &
p2conf == 1 & correct == p2rslt),
LH2 = sum(p1conf == 1 &
p2conf == 0 & correct == p2rslt),
HL2 = sum(p1conf == 0 &
p2conf == 1 & correct == p2rslt),
)
print(data)
packages <- c('tidyverse', 'Cairo', 'dqrng', 'readr')
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))
rm(packages, installed_packages)
library()
simData <-
read_csv("l-4-6-afa.csv",
col_types = cols(cntBalance = col_skip(),
rt = col_skip()))
set.seed(1)
trls <- 400
simTibble <- tibble(
subID = 'ler',
trialNum = 1:trls,
confRNG1 = dqrunif(trls),
confRNG2 = dqrunif(trls),
accRNG1 = dqrunif(trls),
accRNG2 = dqrunif(trls),
correctRNG = dqrunif(trls),
p1conf = if_else(confRNG1 < .5, 0, 1),
p1rslt = if_else(p1conf == 1,
if_else(accRNG1 < .8, 1, 0),
if_else(accRNG1 < .6, 1, 0)),
p2conf = if_else(confRNG2 < .5, 0, 1),
p2rslt = if_else(p2conf == 1,
if_else(accRNG2 < .7, 1, 0),
if_else(accRNG2 < .7, 1, 0)),
correct = if_else(correctRNG < .5, 0, 1),
) %>%
select(subID, trialNum, correct, p1conf, p2conf, p1rslt, p2rslt)
data <- mutate(simData,
advAgree = ifelse(p1rslt == p2rslt, 1, 0),
correct = ifelse(correct==TRUE,1,0)
) %>%
filter(advAgree == 0) %>%
group_by(subID) %>%
summarise(
disagree = sum(advAgree != ''),
LL = sum(p1conf == 0 & p2conf == 0),
HH = sum(p1conf == 1 & p2conf == 1),
LH = sum(p1conf == 1 & p2conf == 0),
HL = sum(p1conf == 0 & p2conf == 1),
LL1 = sum(p1conf == 0 &
p2conf == 0 & correct == p1rslt),
HH1 = sum(p1conf == 1 &
p2conf == 1 & correct == p1rslt),
LH1 = sum(p1conf == 1 &
p2conf == 0 & correct == p1rslt),
HL1 = sum(p1conf == 0 &
p2conf == 1 & correct == p1rslt),
LL2 = sum(p1conf == 0 &
p2conf == 0 & correct == p2rslt),
HH2 = sum(p1conf == 1 &
p2conf == 1 & correct == p2rslt),
LH2 = sum(p1conf == 1 &
p2conf == 0 & correct == p2rslt),
HL2 = sum(p1conf == 0 &
p2conf == 1 & correct == p2rslt),
)
print(data)
startup <- function() {
renv::isolate()
packages <- c('tidyverse', 'Cairo', 'dqrng', 'readr')
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))
rm(packages, installed_packages)
}
startup()
rm(list = ls())
data <- read_csv(
"22-5-4 to 22-5-4 Data.csv",
col_types = cols(
trialNum = col_integer(),
rt = col_double(),
#correct = col_logical(),
winner = col_integer(),
p1conf = col_integer(),
p2conf = col_integer(),
p1rslt = col_integer(),
p2rslt = col_integer(),
...11 = col_skip()
)
)
filter(data, cntBalance=='L') %>%
mutate(hiConf = p1conf,
hiRslt = p1conf,
loConf = p2conf,
loRslt = p2rslt) %>%
select(-c(7, 8, 9, 10))
trialProportionPlot <- function(qwer) {
dataLonly <- filter(data, subID == qwer)
varName = c('lo', 'hi')
for (i in 0:1) {
assign(
paste0('A1', varName[i + 1]),
filter(dataLonly, p1conf == i) %>%
mutate(
winSum = cumsum(p1rslt),
proportion = winSum / 1:length(winSum),
group = paste0('A1', varName[i + 1])
),
envir = globalenv()
)
assign(
paste0('A2', varName[i + 1]),
filter(dataLonly, p2conf == i) %>%
mutate(
winSum = cumsum(p2rslt),
proportion = winSum / 1:length(winSum),
group = paste0('A2', varName[i + 1])
),
envir = globalenv()
)
graphData <<- bind_rows(A1hi,
A1lo,
A2hi,
A2lo) %>%
arrange(group) %>%
select(trialNum, proportion, group)
}
ggplot(graphData,
aes(
x = trialNum,
y = proportion,
group = group,
color = group
)) +
scale_color_manual(
values = c(
A1hi = 'red',
A1lo = 'blue',
A2hi = 'orange',
A2lo = 'green'
),
name = 'Advisor Judgement',
labels = c(
'Calibrated High',
'Calibrated Low',
'Non-Calibrated High',
'Non-Calibrated Low'
)
) +
labs(title = "Simulated Correct Proportions",
x = "Trial Number", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1)) +
#coord_cartesian(xlim = c(0, 50)) +
geom_step()
}
trialProportionPlot('bsp')
trialProportionPlot('aya')
